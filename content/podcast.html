---
title: "The Sigmacast"
date: 2024-04-15
draft: false
---

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Welcome To The Sigmacast</title>

<style>

/* ---------- THEME SYSTEM ---------- */

:root {
    color-scheme: light dark;

    /* Default to dark-safe values */
    --modal-bg: #1c1c1e;
    --modal-text: #f2f2f7;
    --modal-overlay: rgba(0,0,0,0.7);
}

/* Light mode override */
@media (prefers-color-scheme: light) {
    :root {
        --modal-bg: #ffffff;
        --modal-text: #111111;
        --modal-overlay: rgba(0,0,0,0.5);
    }
}

/* ---------- BUTTONS ---------- */

.button {
    display: inline-block;
    padding: 8px 15px;
    margin: 5px;
    border-radius: 6px;
    text-decoration: none;
    font-size: 14px;
    cursor: pointer;
    color: white;
    background: #1DB954;
    transition: opacity 0.2s ease;
}

.button:hover {
    opacity: 0.85;
}

.button.spotify, .button.apple {
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    padding: 0;
    margin-right: 5px;
    background-color: transparent;
}

.button.spotify {
    background-image: url('https://storage.googleapis.com/pr-newsroom-wp/1/2023/05/Spotify_Primary_Logo_RGB_Green.png');
    width: 24px;
    height: 24px;
}

.button.apple {
    background-image: url('https://logodownload.org/wp-content/uploads/2019/08/apple-podcasts-logo-0.png');
    width: 37.5px;
    height: 37.5px;
}

.button.transcript {
    background: #555;
}

/* ---------- MODAL ---------- */

#transcriptModal {
    position: fixed;
    inset: 0;
    background: var(--modal-overlay);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    backdrop-filter: blur(4px);
}

#transcriptContent {
    width: 90%;
    max-width: 900px;
    max-height: 85vh;
    border-radius: 14px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--modal-bg);
    color: var(--modal-text);
    box-shadow: 0 10px 40px rgba(0,0,0,0.5);
}

#transcriptHeader {
    padding: 15px 20px;
    background: #1DB954;
    color: white;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#transcriptBody {
    padding: 20px;
    overflow-y: auto;
    font-family: system-ui, sans-serif;
    font-size: 15px;
    line-height: 1.6;
    white-space: pre-wrap;
}

.close-btn {
    background: none;
    border: none;
    color: white;
    font-size: 20px;
    cursor: pointer;
}

</style>
</head>

<body>

<div id="introduction">
<p>Your hub for Ergo content across two channels.</p>
</div>

<div id="episodes"></div>

<!-- Transcript Modal -->
<div id="transcriptModal">
    <div id="transcriptContent">
        <div id="transcriptHeader">
            <span id="transcriptTitle">Transcript</span>
            <div>
                <a id="downloadTranscriptBtn" class="button" target="_blank">Download</a>
                <button class="close-btn" onclick="closeTranscript()">âœ•</button>
            </div>
        </div>
        <div id="transcriptBody"></div>
    </div>
</div>

<script>

/* ---------- RSS ---------- */

function fetchAndDisplayEpisodes(feedUrl) {
    return fetch(feedUrl)
        .then(r => r.text())
        .then(str => new DOMParser().parseFromString(str, 'text/xml'))
        .then(data => {
            return Array.from(data.querySelectorAll('item')).map(item => {
                const transcriptTag = item.getElementsByTagName('podcast:transcript')[0];

                return {
                    title: item.querySelector('title').textContent,
                    description: item.querySelector('description').textContent,
                    listenLink: item.querySelector('link').textContent,
                    enclosureUrl: item.querySelector('enclosure').getAttribute('url'),
                    pubDate: new Date(item.querySelector('pubDate').textContent),
                    transcriptUrl: transcriptTag ? transcriptTag.getAttribute('url') : null
                };
            });
        });
}

Promise.all([
    fetchAndDisplayEpisodes('https://anchor.fm/s/f21c6414/podcast/rss'),
    fetchAndDisplayEpisodes('https://anchor.fm/s/d094dce0/podcast/rss')
]).then(([a, b]) => {

    const all = a.concat(b).sort((x,y)=> y.pubDate - x.pubDate);
    const container = document.getElementById('episodes');

    all.forEach(ep => {

        const div = document.createElement('div');

        const h2 = document.createElement('h2');
        h2.textContent = ep.title;

        const desc = document.createElement('div');
        desc.innerHTML = ep.description;

        const btnWrap = document.createElement('div');

        const dl = document.createElement('a');
        dl.className = 'button';
        dl.textContent = 'Download';
        dl.href = ep.enclosureUrl;

        btnWrap.appendChild(dl);

        if (ep.transcriptUrl) {
            const tbtn = document.createElement('a');
            tbtn.className = 'button transcript';
            tbtn.textContent = 'Read Transcript';
            tbtn.href = 'javascript:void(0)';
            tbtn.onclick = () => openTranscript(ep.title, ep.transcriptUrl);
            btnWrap.appendChild(tbtn);
        }

        div.appendChild(h2);
        div.appendChild(desc);
        div.appendChild(btnWrap);
        container.appendChild(div);
    });

});

/* ---------- TRANSCRIPT ---------- */

function openTranscript(title, url) {

    const modal = document.getElementById('transcriptModal');
    const body = document.getElementById('transcriptBody');
    const titleElem = document.getElementById('transcriptTitle');
    const downloadBtn = document.getElementById('downloadTranscriptBtn');

    titleElem.textContent = title;
    body.textContent = 'Loading transcript...';

    const proxied = 'https://api.codetabs.com/v1/proxy/?quest=' + encodeURIComponent(url);

    downloadBtn.href = proxied;
    downloadBtn.download = title + '.srt';

    modal.style.display = 'flex';

    fetch(proxied)
        .then(res => {
            if (!res.ok) throw new Error("Proxy failed");
            return res.text();
        })
        .then(text => {

            if (!text || text.length < 20) {
                throw new Error("Empty transcript");
            }

            body.textContent = formatSRT(text);
        })
        .catch(err => {
            body.textContent = "Failed to load transcript via proxy.";
            console.error(err);
        });
}

function closeTranscript() {
    document.getElementById('transcriptModal').style.display = 'none';
}

document.getElementById('transcriptModal').addEventListener('click', function(e){
    if (e.target === this) closeTranscript();
});

/* Clean SRT formatting */
function formatSRT(data) {
    return data
        .replace(/\r/g, '')
        .replace(/^\d+$/gm, '')
        .replace(/\d{2}:\d{2}:\d{2},\d{3} --> .*$/gm, '')
        .trim();
}

</script>

</body>
